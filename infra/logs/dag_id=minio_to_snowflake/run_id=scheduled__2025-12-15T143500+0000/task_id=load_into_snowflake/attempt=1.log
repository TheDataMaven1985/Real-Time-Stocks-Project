[2025-12-15T14:40:53.796+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-12-15T14:40:54.202+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: minio_to_snowflake.load_into_snowflake scheduled__2025-12-15T14:35:00+00:00 [queued]>
[2025-12-15T14:40:54.276+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: minio_to_snowflake.load_into_snowflake scheduled__2025-12-15T14:35:00+00:00 [queued]>
[2025-12-15T14:40:54.281+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 3
[2025-12-15T14:40:54.470+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): load_into_snowflake> on 2025-12-15 14:35:00+00:00
[2025-12-15T14:40:54.529+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'minio_to_snowflake', 'load_into_snowflake', 'scheduled__2025-12-15T14:35:00+00:00', '--job-id', '110', '--raw', '--subdir', 'DAGS_FOLDER/minio_to_snowflake.py', '--cfg-path', '/tmp/tmpjvm_paav']
[2025-12-15T14:40:54.565+0000] {standard_task_runner.py:91} INFO - Job 110: Subtask load_into_snowflake
[2025-12-15T14:40:54.573+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62 DeprecationWarning: This process (pid=7251) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-12-15T14:40:54.596+0000] {standard_task_runner.py:64} INFO - Started process 7276 to run task
[2025-12-15T14:40:55.023+0000] {task_command.py:426} INFO - Running <TaskInstance: minio_to_snowflake.load_into_snowflake scheduled__2025-12-15T14:35:00+00:00 [running]> on host 4abec113d47e
[2025-12-15T14:40:55.636+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='minio_to_snowflake' AIRFLOW_CTX_TASK_ID='load_into_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2025-12-15T14:35:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-12-15T14:35:00+00:00'
[2025-12-15T14:40:55.664+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-12-15T14:40:55.824+0000] {logging_mixin.py:188} INFO - Received 265 files from previous task.
[2025-12-15T14:40:55.836+0000] {logging_mixin.py:188} INFO - Cnnecting to Snowflake...
[2025-12-15T14:40:55.855+0000] {connection.py:408} INFO - Snowflake Connector for Python Version: 3.11.0, Python Version: 3.12.4, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[2025-12-15T14:40:55.859+0000] {connection.py:1258} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-12-15T14:40:57.317+0000] {logging_mixin.py:188} INFO - Connected to Snowflake.
[2025-12-15T14:40:59.213+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765699149.json
[2025-12-15T14:41:00.190+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700319.json
[2025-12-15T14:41:01.095+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700445.json
[2025-12-15T14:41:01.973+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700570.json
[2025-12-15T14:41:02.794+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700695.json
[2025-12-15T14:41:03.605+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700820.json
[2025-12-15T14:41:04.599+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700944.json
[2025-12-15T14:41:05.400+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701068.json
[2025-12-15T14:41:06.358+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701195.json
[2025-12-15T14:41:07.263+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701319.json
[2025-12-15T14:41:08.072+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701444.json
[2025-12-15T14:41:08.877+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701569.json
[2025-12-15T14:41:09.697+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701708.json
[2025-12-15T14:41:10.540+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701834.json
[2025-12-15T14:41:11.438+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701960.json
[2025-12-15T14:41:12.304+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702086.json
[2025-12-15T14:41:13.860+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702212.json
[2025-12-15T14:41:14.979+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702339.json
[2025-12-15T14:41:15.929+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702464.json
[2025-12-15T14:41:16.906+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702590.json
[2025-12-15T14:41:17.806+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702715.json
[2025-12-15T14:41:18.782+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702840.json
[2025-12-15T14:41:19.862+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702967.json
[2025-12-15T14:41:20.651+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703092.json
[2025-12-15T14:41:21.560+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703217.json
[2025-12-15T14:41:22.585+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703342.json
[2025-12-15T14:41:23.514+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703468.json
[2025-12-15T14:41:24.650+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703593.json
[2025-12-15T14:41:25.583+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703717.json
[2025-12-15T14:41:26.589+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703841.json
[2025-12-15T14:41:27.475+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703966.json
[2025-12-15T14:41:28.450+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765704090.json
[2025-12-15T14:41:29.423+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765704215.json
[2025-12-15T14:41:30.835+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765704339.json
[2025-12-15T14:41:31.777+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765704464.json
[2025-12-15T14:41:32.864+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765704588.json
[2025-12-15T14:41:33.756+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765704712.json
[2025-12-15T14:41:34.923+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765704837.json
[2025-12-15T14:41:35.981+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765704961.json
[2025-12-15T14:41:36.836+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765705086.json
[2025-12-15T14:41:37.758+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765705210.json
[2025-12-15T14:41:38.588+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765705335.json
[2025-12-15T14:41:39.487+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765705459.json
[2025-12-15T14:41:40.424+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765705591.json
[2025-12-15T14:41:41.325+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765705724.json
[2025-12-15T14:41:42.174+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765705856.json
[2025-12-15T14:41:42.981+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765706004.json
[2025-12-15T14:41:43.856+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765706174.json
[2025-12-15T14:41:44.659+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765706317.json
[2025-12-15T14:41:45.470+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765706443.json
[2025-12-15T14:41:46.335+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765706568.json
[2025-12-15T14:41:47.225+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765706694.json
[2025-12-15T14:41:48.178+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765706820.json
[2025-12-15T14:41:49.037+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765699206.json
[2025-12-15T14:41:49.794+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700358.json
[2025-12-15T14:41:50.612+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700483.json
[2025-12-15T14:41:51.363+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700609.json
[2025-12-15T14:41:52.159+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700734.json
[2025-12-15T14:41:52.977+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700858.json
[2025-12-15T14:41:53.709+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765700983.json
[2025-12-15T14:41:54.524+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701108.json
[2025-12-15T14:41:55.310+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701234.json
[2025-12-15T14:41:56.105+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701359.json
[2025-12-15T14:41:57.379+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701483.json
[2025-12-15T14:42:01.467+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701607.json
[2025-12-15T14:42:10.186+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701748.json
[2025-12-15T14:42:11.173+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701874.json
[2025-12-15T14:42:12.309+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765701999.json
[2025-12-15T14:42:13.325+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702125.json
[2025-12-15T14:42:14.379+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702252.json
[2025-12-15T14:42:15.357+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702378.json
[2025-12-15T14:42:16.346+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702503.json
[2025-12-15T14:42:17.142+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702628.json
[2025-12-15T14:42:17.945+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702754.json
[2025-12-15T14:42:18.814+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765702880.json
[2025-12-15T14:42:19.926+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703006.json
[2025-12-15T14:42:20.744+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703131.json
[2025-12-15T14:42:21.650+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703256.json
[2025-12-15T14:42:22.540+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703381.json
[2025-12-15T14:42:23.436+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703507.json
[2025-12-15T14:42:24.375+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703631.json
[2025-12-15T14:42:25.246+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703756.json
[2025-12-15T14:42:26.062+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765703880.json
[2025-12-15T14:42:27.467+0000] {logging_mixin.py:188} INFO - Uploaded file to Snowflake stage: /tmp/minio_data/1765704004.json
[2025-12-15T14:42:35.987+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x726825bffa10>: Failed to establish a new connection: [Errno -2] Name or service not known')': /4sob1000-s/tables/12560761461/1765704129.json.gz
[2025-12-15T15:32:52.185+0000] {local_task_job_runner.py:214} ERROR - Heartbeat time limit exceeded!
[2025-12-15T15:32:52.561+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-12-15T15:32:53.823+0000] {storage_client.py:318} WARNING - PUT with url b'https://sfc-uk-ds1-28-customer-stage.s3.amazonaws.com/4sob1000-s/tables/12560761461/1765704129.json.gz' failed for transient error: HTTPSConnectionPool(host='sfc-uk-ds1-28-customer-stage.s3.amazonaws.com', port=443): Max retries exceeded with url: /4sob1000-s/tables/12560761461/1765704129.json.gz (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x726825bf2330>: Failed to establish a new connection: [Errno -2] Name or service not known'))
[2025-12-15T15:32:54.344+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x726825bdb140>: Failed to establish a new connection: [Errno -2] Name or service not known')': /4sob1000-s/tables/12560761461/1765704129.json.gz
[2025-12-15T15:32:55.009+0000] {process_utils.py:132} INFO - Sending 15 to group 7276. PIDs of all processes in the group: [7276]
[2025-12-15T15:32:55.262+0000] {process_utils.py:87} INFO - Sending the signal 15 to group 7276
[2025-12-15T15:32:55.358+0000] {taskinstance.py:2611} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-12-15T15:32:55.611+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-12-15T15:32:56.077+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/minio_to_snowflake.py", line 96, in load_into_snowflake
    cur.execute(f"""PUT file://{f} @%bronze_stock_quotes_raw""")
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/cursor.py", line 1046, in execute
    sf_file_transfer_agent.execute()
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/file_transfer_agent.py", line 436, in execute
    self.transfer(self._file_metadata)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/file_transfer_agent.py", line 652, in transfer
    cv_main_thread.wait()
  File "/usr/local/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 2613, in signal_handler
    raise AirflowTaskTerminated("Task received SIGTERM signal")
airflow.exceptions.AirflowTaskTerminated: Task received SIGTERM signal
[2025-12-15T15:32:57.364+0000] {storage_client.py:318} WARNING - PUT with url b'https://sfc-uk-ds1-28-customer-stage.s3.amazonaws.com/4sob1000-s/tables/12560761461/1765704129.json.gz' failed for transient error: HTTPSConnectionPool(host='sfc-uk-ds1-28-customer-stage.s3.amazonaws.com', port=443): Max retries exceeded with url: /4sob1000-s/tables/12560761461/1765704129.json.gz (Caused by NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x726825bdad20>: Failed to establish a new connection: [Errno -2] Name or service not known'))
[2025-12-15T15:32:58.775+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=minio_to_snowflake, task_id=load_into_snowflake, run_id=scheduled__2025-12-15T14:35:00+00:00, execution_date=20251215T143500, start_date=20251215T144054, end_date=20251215T153258
[2025-12-15T15:32:58.949+0000] {connectionpool.py:824} WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<snowflake.connector.vendored.urllib3.connection.HTTPSConnection object at 0x726825a509e0>: Failed to establish a new connection: [Errno -2] Name or service not known')': /4sob1000-s/tables/12560761461/1765704129.json.gz
[2025-12-15T15:33:02.019+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=7276, status='terminated', exitcode=2, started='14:40:54') (7276) terminated with exit code 2
